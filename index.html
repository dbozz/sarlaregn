<!DOCTYPE html>
<html>
<head>
<base href="/">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-N8G16WFMLV"></script>
<script>
window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-N8G16WFMLV');

if(/^((?!chrome).)*safari/i.test(navigator.userAgent)) {
    var head = document.getElementsByTagName("head")[0];
    var script = document.createElement("script");
    script.setAttribute("type", "text/javascript");
    script.setAttribute("src", "js/indexeddbshim.min.js");
    head.appendChild(script);
}
</script>

	<title>SÄRLAREGN</title>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=0">
	<meta name="mobile-web-app-capable" content="yes">
	<meta name="apple-mobile-web-app-capable" content="yes">
	<meta name="description" content="Maranatafolkets sångbok. Utkom i sin första utgåva 1965 och innehåller idag 712 sånger.">
	<link rel="manifest" href="manifest.webmanifest">
 	<link rel="icon" sizes="192x192" href="maskable_icon_x192.png">
	<link rel="icon" sizes="128x128" href="maskable_icon_x128.png">
	<link rel="apple-touch-icon" sizes="192x192" href="maskable_icon_x512.png">
	<link rel="preconnect" href="https://fonts.googleapis.com">
	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link href="https://fonts.googleapis.com/css2?family=Source+Sans+3:ital,wght@0,200..900;1,200..900&display=swap" rel="stylesheet">
	<link rel="stylesheet" type="text/css" href="style.css?v=20251130-165309">
	<link rel="stylesheet" href="jquery-ui.min.css">
	<script type="text/javascript" src="js/jquery.min.js"></script>
	<script type="text/javascript" src="js/jquery-ui.min.js"></script>
	<script src="js.cookie.js"></script>
	<script src="js/jquery.touchSwipe.min.js"></script>
	<script src="https://unpkg.com/dexie@4.0.8/dist/dexie.js"></script>
	<!--script src="https://unpkg.com/dexie/dist/dexie.js"></script-->
	<script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
	<script type="text/javascript" src="js/functions.js?v=20251130-165309"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.1.1/crypto-js.min.js"></script>
	<script src="https://cdn.jsdelivr.net/npm/fernet@0.3.2/fernetBrowser.min.js"></script>
	
</head>


<body>
<div id="intro">
  <video autoplay muted loop playsinline>
    <source src="video.webm" type="video/webm">
    <source src="video.mp4" type="video/mp4">
  </video>
  <h1>SÄRLA<br>REGN</h1>
</div>
  <div id="everything">
    <div id="bottom">
      <div class="logobg">
        <video autoplay muted loop playsinline>
          <source src="video.webm" type="video/webm">
          <source src="video.mp4" type="video/mp4">
        </video>
        <div class="overlay-text">
          SÄRLAREGN
        </div>
	</div>
	<!--div id=bottom2></div-->
	<div class=head>
		<div id=search>
		<input onclick="this.value=''; setFocusTo('sok');" id=sok type=text name=sok class="sokcss typeahead tt-query" autocomplete=off placeholder="Nr eller fritext">
		</div>
	<!--div class="browsemenu"><a href="javascript:selectPrev(5000);" class=navPrev id=sPrev><img src=images/arrowleft.png class=arrowleft></a><a href="javascript:selectNext(1000);" class=navNext id=sNext><img src=images/arrowright.png class=arrowright></a></div-->
	</div>
	</div>

	<div class="body">

		<div id="lyric_head">
			<div class="menu-section">
				<a href="javascript:bookmarks();" class="menu-btn">☆☆...</a>
			</div>

			<div class="menu-section" id="bm_field">
			</div>

			<div class="menu-section" id="song-actions" style="display:none;">
				<a href="javascript:ttc()" class="menu-btn" title="Kopiera text">⧉txt</a>
				<a href="javascript:copyLink()" class="menu-btn" title="Kopiera URL">⧉url</a>
				<a href="#" id="opensong-download" class="menu-btn" title="Ladda ner som OpenSong">⤓xml</a>
				<a href="#" id="pdf-download" class="menu-btn" title="Ladda ner som PDF">⤓pdf</a>
			</div>

			<div class="menu-section">
				<a href="#" class="menu-btn" id="sPrev" title="Föregående">«</a>
				<a href="#" class="menu-btn" id="sNext" title="Nästa">»</a>
			</div>

		<div class="menu-section">
			<a href="javascript:changeFontSize(true);" class="menu-btn" title="Öka text">A+</a>
			<a href="javascript:changeFontSize(false);" class="menu-btn" title="Minska text">A–</a>
		</div>			<div class="menu-section">
				<a href="javascript:loadPage('about');" class="menu-btn" title="Om">ⓘ</a>
				<a href="javascript:loadPage('help');" class="menu-btn" title="Hjälp">?</a>
				<a href="javascript:loadPage('settings');" class="menu-btn" title="Inställningar">⚙️</a>
			</div>
		</div>

	<div class="container">

		<div id="lyric-container">
			<div id="lyric">
				<div class="pt">Välkommen!</div> <div>Sök efter sånger med fritext eller nummer i sökrutan längst upp på sidan. </div>
				<div>Ny funktion: Under Inställningar kan du nu stänga av radbrytningar i versar.</div>
			</div>	
		</div>

	</div>

	</div>
</div>
<script>
var timeoutId;
$(document).ready(function() {
        $('#key1').on('input propertychange change', function() {
                clearTimeout(timeoutId);
                timeoutId = setTimeout(function() {
                        updateKey1();
                        }, 100);
                });
        });

function updateKey1() {
        var key1 = $('#key1').val();
        Cookies.set('key1', key1);
        }
</script>
<script>
  // Update activity timestamp cookie
  function updateActivity() {
    const now = Date.now();
    document.cookie = `lastActivity=${now}; path=/; max-age=31536000; SameSite=Lax`;
  }
  
  // Check if user was recently active (within 1 hour)
  function wasRecentlyActive() {
    const cookies = document.cookie.split(';');
    for (let cookie of cookies) {
      const [name, value] = cookie.trim().split('=');
      if (name === 'lastActivity') {
        const lastActivity = parseInt(value);
        const oneHour = 60 * 60 * 1000; // 1 hour in milliseconds
        return (Date.now() - lastActivity) < oneHour;
      }
    }
    return false;
  }
  
  // Update activity on page load and user interactions
  updateActivity();
  document.addEventListener('click', updateActivity);
  document.addEventListener('keypress', updateActivity);
  document.addEventListener('scroll', updateActivity);
  
  // Splash screen logic
  const intro = document.getElementById('intro');
  const isRootPage = window.location.pathname === '/' && window.location.search === '';
  const shouldShowIntro = isRootPage && !wasRecentlyActive();
  
  if (!shouldShowIntro) {
    // Hide intro immediately if not on root page or user was recently active
    intro.style.display = 'none';
    document.body.style.overflow = 'auto';
  } else {
    // Show intro and setup auto-hide after 5 seconds
    let introTimeout;
    
    const hideIntro = () => {
      if (introTimeout) clearTimeout(introTimeout);
      intro.classList.add('fade-out');
      setTimeout(() => {
        intro.style.display = 'none';
        document.body.style.overflow = 'auto';
        updateActivity(); // Update timestamp when splash is dismissed
      }, 800);
    };
    
    // Auto-hide after 5 seconds
    introTimeout = setTimeout(hideIntro, 5000);
    
    // Also allow manual click to hide
    intro.addEventListener('click', hideIntro);
  }
</script>

</body>
</html>

